<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mbe evidence question bank</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #e6f2ff;
            font-family: 'Times New Roman', Times, serif;
            color: #000;
            padding: 40px 20px;
            line-height: 1.6;
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: normal;
            margin-bottom: 10px;
            text-align: center;
        }
        
        h2 {
            font-size: 1.5rem;
            font-weight: normal;
            margin: 30px 0 20px 0;
            text-align: center;
        }
        
        .subtitle {
            font-size: 0.95rem;
            text-align: center;
            margin: 5px 0;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .center-text {
            text-align: center;
        }
        
        a {
            color: #551a8b;
            text-decoration: underline;
        }
        
        a:visited {
            color: #551a8b;
        }
        
        a:hover {
            color: #0000ee;
        }
        
        /* Navigation/Mode Toggle */
        .nav {
            margin: 30px 0;
            text-align: center;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #fff;
            border: 2px solid #000;
            padding: 10px 25px;
            cursor: pointer;
            font-family: 'Times New Roman', Times, serif;
            font-size: 1rem;
            transition: all 0.2s ease;
        }
        
        .nav-btn:hover {
            background: #f0f0f0;
        }
        
        .nav-btn.active {
            background: #551a8b;
            color: #fff;
        }
        
        /* Quiz Mode */
        #quizMode {
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .quiz-header {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #fff;
            border: 1px solid #999;
        }
        
        .quiz-progress {
            font-size: 1rem;
            color: #666;
            margin-bottom: 10px;
        }
        
        .quiz-counter {
            font-size: 1.2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .quiz-container {
            background: #fff;
            border: 1px solid #999;
            padding: 40px 30px;
            margin: 30px 0;
        }
        
        .scenario {
            color: #666;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .question-text {
            font-size: 1.15rem;
            font-weight: bold;
            margin: 20px 0 30px 0;
            line-height: 1.5;
        }
        
        .choices {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 30px 0;
        }
        
        .choice {
            padding: 12px 15px;
            border: 1px solid #ccc;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #fff;
        }
        
        .choice:hover {
            background: #f9f9f9;
            border-color: #551a8b;
        }
        
        .choice-letter {
            font-weight: bold;
            margin-right: 10px;
        }
        
        .answer-reveal {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #551a8b;
            display: none;
        }
        
        .answer-reveal.visible {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .correct-answer {
            color: #2d5016;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }
        
        .explanation {
            background: #f5f5f5;
            padding: 15px;
            border-left: 3px solid #551a8b;
            margin-top: 10px;
            color: #333;
        }
        
        .explanation-title {
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .show-answer-btn {
            background: #fff;
            border: 1px solid #000;
            padding: 10px 25px;
            cursor: pointer;
            font-family: 'Times New Roman', Times, serif;
            font-size: 0.95rem;
            margin: 20px 0;
            transition: all 0.2s ease;
        }
        
        .show-answer-btn:hover {
            background: #f0f0f0;
        }
        
        .show-answer-btn.hidden-answer:after {
            content: " ▼";
        }
        
        .show-answer-btn.show-answer:after {
            content: " ▲";
        }
        
        .quiz-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            gap: 15px;
        }
        
        .quiz-nav button {
            background: #fff;
            border: 1px solid #000;
            padding: 10px 20px;
            cursor: pointer;
            font-family: 'Times New Roman', Times, serif;
            font-size: 0.95rem;
            transition: all 0.2s ease;
        }
        
        .quiz-nav button:hover {
            background: #f0f0f0;
        }
        
        .quiz-nav button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .new-quiz-btn {
            background: #551a8b !important;
            color: #fff !important;
        }
        
        .new-quiz-btn:hover {
            background: #6b2a9b !important;
        }
        
        /* Library Mode */
        #libraryMode {
            animation: fadeIn 0.3s ease;
        }
        
        .library-controls {
            background: #fff;
            border: 1px solid #999;
            padding: 20px;
            margin: 20px 0;
        }
        
        .search-box {
            width: 100%;
            padding: 10px;
            font-family: 'Times New Roman', Times, serif;
            font-size: 1rem;
            border: 1px solid #999;
            margin-bottom: 15px;
        }
        
        .filter-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filter-row label {
            font-weight: bold;
        }
        
        .filter-row select {
            font-family: 'Times New Roman', Times, serif;
            padding: 5px 10px;
            border: 1px solid #999;
        }
        
        .library-stats {
            text-align: center;
            font-size: 0.9rem;
            color: #666;
            margin: 15px 0;
            padding: 10px;
            background: #f9f9f9;
        }
        
        .question-card {
            border: 1px solid #999;
            padding: 20px;
            margin: 15px 0;
            background: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .question-card:hover {
            border-color: #551a8b;
            box-shadow: 0 2px 8px rgba(85, 26, 139, 0.1);
        }
        
        .question-card.expanded {
            border-color: #551a8b;
            background: #fafafa;
        }
        
        .question-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .question-card-title {
            font-weight: bold;
            margin-bottom: 8px;
            flex: 1;
        }
        
        .question-card-meta {
            font-size: 0.85rem;
            color: #999;
            margin-bottom: 10px;
        }
        
        .question-card-content {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }
        
        .question-card.expanded .question-card-content {
            display: block;
        }
        
        .card-scenario {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .card-choices {
            margin: 15px 0;
            padding-left: 20px;
        }
        
        .card-choice {
            margin: 8px 0;
        }
        
        .card-answer {
            background: #f5f5f5;
            padding: 12px;
            border-left: 3px solid #551a8b;
            margin-top: 15px;
        }
        
        .card-answer-label {
            color: #2d5016;
            font-weight: bold;
        }
        
        .expand-icon {
            color: #551a8b;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .hidden {
            display: none;
        }
        
        .footer {
            margin-top: 50px;
            text-align: center;
            font-size: 0.85rem;
            color: #666;
            border-top: 1px solid #999;
            padding-top: 20px;
        }
        
        .empty-message {
            text-align: center;
            padding: 30px;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>mbe evidence question bank</h1>
    <p class="subtitle">made by grace kantrow</p>
    
    <div class="container">
        <!-- Navigation -->
        <div class="nav">
            <button class="nav-btn active" onclick="switchMode('quiz')">quiz mode</button>
            <button class="nav-btn" onclick="switchMode('library')">library</button>
        </div>
        
        <!-- QUIZ MODE -->
        <div id="quizMode">
            <div class="quiz-header">
                <div class="quiz-progress">practice test</div>
                <div class="quiz-counter">
                    <span id="currentQuestion">1</span> / <span id="totalQuestions">10</span>
                </div>
                <button class="nav-btn" style="margin-top: 15px;" onclick="generateNewQuiz()">new quiz</button>
            </div>
            
            <div class="quiz-container">
                <div id="scenarioContainer" class="scenario"></div>
                <div id="questionContainer" class="question-text"></div>
                <div id="choicesContainer" class="choices"></div>
                <button id="showAnswerBtn" class="show-answer-btn hidden-answer" onclick="toggleAnswer()">show answer</button>
                <div id="answerContainer" class="answer-reveal"></div>
            </div>
            
            <div class="quiz-nav">
                <button id="prevBtn" onclick="previousQuestion()" disabled>← previous</button>
                <span id="navInfo" style="text-align: center; flex: 1;"></span>
                <button id="nextBtn" onclick="nextQuestion()">next →</button>
            </div>
        </div>
        
        <!-- LIBRARY MODE -->
        <div id="libraryMode" class="hidden">
            <h2>question library</h2>
            
            <div class="library-controls">
                <input 
                    type="text" 
                    class="search-box" 
                    id="searchBox" 
                    placeholder="search by question, topic, or scenario..."
                    onkeyup="filterLibrary()"
                >
                <div class="filter-row">
                    <label>filter by source:</label>
                    <select id="sourceFilter" onchange="filterLibrary()">
                        <option value="">all sources</option>
                    </select>
                </div>
            </div>
            
            <div class="library-stats" id="libraryStats"></div>
            
            <div id="libraryContainer"></div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <p id="totalQuestionsFooter"></p>
            <p style="margin-top: 10px; font-size: 0.8rem;">last updated: december 2025</p>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script>
        // State management
        let allQuestions = [];
        let currentQuiz = [];
        let currentQuizIndex = 0;
        let answeredQuestions = {};
        let libraryFilteredQuestions = [];
        
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQO6F1Nsq-Hb1pHoy-14qThBwskNAz2hhVnJ5gzPhwMiXxJHLQ70Kg0n-thpegNVxSHWwald9sz5V6s/pub?gid=0&single=true&output=csv';
        
        // Initialize on load - try multiple ways
        if (document.readyState !== 'loading') {
            console.log('Document already loaded, initializing immediately');
            loadQuestions();
        } else {
            document.addEventListener('DOMContentLoaded', function() {
                console.log('DOMContentLoaded event fired');
                loadQuestions();
            });
        }
        
        function loadQuestions() {
            console.log('Attempting to load from:', CSV_URL);
            
            fetch(CSV_URL)
                .then(response => {
                    console.log('Response status:', response.status);
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    return response.text();
                })
                .then(csv => {
                    console.log('CSV loaded, parsing...');
                    Papa.parse(csv, {
                        header: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            console.log('Parsed questions:', results.data.length);
                            allQuestions = results.data.filter(q => q.Question && q.Question.trim());
                            console.log('Filtered questions:', allQuestions.length);
                            if (allQuestions.length > 0) {
                                initializeApp();
                            } else {
                                console.log('No questions found, loading sample data');
                                loadSampleData();
                            }
                        },
                        error: function(err) {
                            console.error('Parse error:', err);
                            loadSampleData();
                        }
                    });
                })
                .catch(err => {
                    console.error('Fetch error:', err);
                    loadSampleData();
                });
        }
        
        function loadSampleData() {
            allQuestions = [
                {
                    Question: "Should the judge grant a motion to strike the medical examiner's testimony?",
                    Scenario: "In a prosecution for aggravated battery, a police officer testified that when he arrested the defendant, he took a knife from the defendant and delivered it to the medical examiner. The medical examiner testified that the knife blade was consistent with the victim's wound but admitted on cross-examination that any number of other knives could also have caused the wound.",
                    Choice_A: "No, because the probative worth of this evidence is for the jury to assess.",
                    Choice_B: "Yes, because in light of the medical examiner's admission, his testimony has insufficient probative value.",
                    Choice_C: "Yes, because the medical examiner could not state the probability that the wound was caused by the defendant's knife.",
                    Choice_D: "Yes, because the probative value is substantially outweighed by the danger of unfair prejudice.",
                    Correct_Answer: "B",
                    Explanation: "Under FRE 403, evidence may be excluded if its probative value is substantially outweighed by the danger of unfair prejudice.",
                    Source: "In-Class MBE"
                },
                {
                    Question: "Which of the following standards of admissibility should the court apply to evidence proffered as relevant to prove whether a contract was formed?",
                    Scenario: "In a civil action for breach of an oral contract, the defendant denied having entered into a contract with the plaintiff, although he admitted that he had discussed doing so.",
                    Choice_A: "Whether a reasonable juror would find the evidence determinative of whether the contract was or was not formed.",
                    Choice_B: "Whether the evidence has any tendency to make the fact of contract formation more or less probable than without the evidence.",
                    Choice_C: "Whether the evidence is sufficient to prove, absent contrary evidence, that the contract was or was not formed.",
                    Choice_D: "Whether the evidence makes it more likely than not that a contract was or was not formed.",
                    Correct_Answer: "B",
                    Explanation: "Relevance is defined as having any tendency to make a fact more or less probable.",
                    Source: "In-Class MBE"
                },
                {
                    Question: "Is the plaintiff's proposed testimony admissible?",
                    Scenario: "A plaintiff sued for injuries arising from a car accident, claiming a back injury. At trial, she wishes to testify that before the accident she had never had any problems with her back.",
                    Choice_A: "No, because the plaintiff has not been qualified as an expert.",
                    Choice_B: "No, because the plaintiff's pain could have been caused by factors arising after the accident, such as an injury at work.",
                    Choice_C: "Yes, because it is probative evidence of the plaintiff's injury.",
                    Choice_D: "Yes, because the testimony of parties is not subject to the lay opinion rule.",
                    Correct_Answer: "C",
                    Explanation: "Lay testimony about the plaintiff's prior physical condition is relevant and probative to damages.",
                    Source: "In-Class MBE"
                },
                {
                    Question: "Should the photograph be admitted over the defendant's objection?",
                    Scenario: "A plaintiff, who had been injured in an automobile collision, sued for damages. The defendant denied negligence and denied that the plaintiff's injuries were severe. At trial, the plaintiff has offered in evidence a color photograph of himself made from a videotape taken by a television news crew at the scene of the collision. The plaintiff has demonstrated that the videotape has since been routinely reused by the television station and that the footage of the plaintiff was erased. The photograph shows the plaintiff moments after the collision, with his bloodied head protruding at a grotesque angle through the broken windshield of his car.",
                    Choice_A: "No, because the plaintiff has failed to establish that a duplicate could not be found.",
                    Choice_B: "No, because the plaintiff has failed to produce the original videotape or a duplicate.",
                    Choice_C: "Yes, because a photograph that establishes a disputed fact cannot be excluded as prejudicial.",
                    Choice_D: "Yes, because it tends to prove a controverted fact.",
                    Correct_Answer: "D",
                    Explanation: "A photograph is admissible if it tends to prove a controverted fact, even if prejudicial.",
                    Source: "In-Class MBE"
                },
                {
                    Question: "Is the witness's testimony admissible?",
                    Scenario: "In a suit based on a will, the distribution of $1 million depends upon whether the wife survived her husband when both died in the crash of a small airplane. An applicable statute provides that, for purposes of distributing an estate after a common disaster, there is a rebuttable presumption that neither spouse survived the other. A witness has been called to testify that as she approached the plane she heard what she thought was a woman's voice saying, 'I'm dying,' although by the time the husband and wife were removed from the wreckage they were both dead.",
                    Choice_A: "No, because the matter is governed by the presumption that neither spouse survived the other.",
                    Choice_B: "No, because the witness's testimony is too speculative to support a finding.",
                    Choice_C: "Yes, because it is relevant and not otherwise prohibited.",
                    Choice_D: "Yes, because the hearsay rule does not apply to statements by decedents in actions to determine rights under a will.",
                    Correct_Answer: "C",
                    Explanation: "A rebuttable presumption may be overcome by relevant evidence.",
                    Source: "In-Class MBE"
                },
                {
                    Question: "Should the court admit this evidence?",
                    Scenario: "A defendant's house was destroyed by fire, and she was charged with arson. To prove that the defendant had a motive to burn down her house, the government offered evidence that the defendant had fully insured the house and its contents.",
                    Choice_A: "No, because evidence of insurance is not admissible on the issue of whether the insured acted wrongfully.",
                    Choice_B: "No, because the probative value of the evidence of insurance on the issue of whether the defendant intentionally burned her house down is substantially outweighed by the dangers of unfair prejudice and confusion of the jury.",
                    Choice_C: "Yes, because any conduct of a party to the case is admissible when offered against the party.",
                    Choice_D: "Yes, because evidence of insurance on the house has a tendency to show that the defendant had a motive to burn down the house.",
                    Correct_Answer: "D",
                    Explanation: "FRE 411 excludes evidence of insurance, but this may be permitted to show ownership or control.",
                    Source: "In-Class MBE"
                },
                {
                    Question: "Is the banker's testimony admissible?",
                    Scenario: "A company sued the defendant, its former vice president, for return of $230,000 that had been embezzled during the previous two years. Called by the company as an adverse witness, the defendant testified that his annual salary had been $75,000, and he denied the embezzlement. The company calls a banker as a witness to show that, during the two-year period, the defendant had deposited $250,000 in his bank account.",
                    Choice_A: "No, because its prejudicial effect substantially outweighs its probative value.",
                    Choice_B: "No, because the deposits could have come from legitimate sources.",
                    Choice_C: "Yes, as circumstantial evidence of the defendant's guilt.",
                    Choice_D: "Yes, to impeach the defendant.",
                    Correct_Answer: "C",
                    Explanation: "Circumstantial evidence is admissible, and inconsistency with defendant's testimony supports its admission.",
                    Source: "In-Class MBE"
                },
                {
                    Question: "Is the testimony concerning the wife's intoxication admissible?",
                    Scenario: "A man sued an auto manufacturer for his wife's death, claiming that a defective steering mechanism on the family car caused it to veer off the road and hit a tree when his wife was driving. The auto manufacturer claims that the steering mechanism was damaged in the collision and offers testimony that the deceased wife was intoxicated at the time of the accident.",
                    Choice_A: "No, because it is improper to prove character evidence by specific conduct.",
                    Choice_B: "No, because it is substantially more prejudicial than probative.",
                    Choice_C: "Yes, as proper evidence of the wife's character.",
                    Choice_D: "Yes, to provide an alternate explanation of the accident's cause.",
                    Correct_Answer: "D",
                    Explanation: "Evidence of an alternate cause is admissible even if it reflects negatively on the plaintiff.",
                    Source: "In-Class MBE"
                },
                {
                    Question: "Is the jail employee's testimony admissible?",
                    Scenario: "A defendant is on trial for kidnapping. The victim has testified that one of the kidnappers referred to the other as 'Speed.' The prosecutor calls a jail employee to testify that, while the defendant was in jail awaiting trial, other inmates addressed the defendant as 'Speed.'",
                    Choice_A: "No, because it is hearsay not within any exception.",
                    Choice_B: "No, because it is substantially more prejudicial than probative.",
                    Choice_C: "Yes, as circumstantial evidence that the defendant was one of the kidnappers.",
                    Choice_D: "Yes, to support the truthfulness of the victim.",
                    Correct_Answer: "C",
                    Explanation: "Circumstantial evidence of identity through a nickname is admissible.",
                    Source: "In-Class MBE"
                },
                {
                    Question: "What is the strongest basis for an objection to the admission of the photographs?",
                    Scenario: "A woman sued a delivery driver for injuries sustained during a car collision. The woman called her treating physician to testify as to the nature and extent of her injuries. The woman now seeks to introduce several color printouts of photographs taken on a smartphone at the accident scene by a witness. The photographs depict the gruesome nature of the woman's injuries.",
                    Choice_A: "The photographs are not relevant in light of the physician's testimony.",
                    Choice_B: "The photographs' probative value is substantially outweighed by the danger of unfair prejudice.",
                    Choice_C: "The photographs violate the best evidence rule.",
                    Choice_D: "The woman did not take the photographs and therefore cannot authenticate them.",
                    Correct_Answer: "B",
                    Explanation: "Under FRE 403, gruesome photographs may be excluded despite relevance if prejudicial effect substantially outweighs probative value.",
                    Source: "In-Class MBE"
                }
            ];
            initializeApp();
        }
        
        function initializeApp() {
            updateSourceFilter();
            generateNewQuiz();
            updateFooter();
        }
        
        function updateSourceFilter() {
            const sources = [...new Set(allQuestions.map(q => q.Source).filter(Boolean))];
            const filterSelect = document.getElementById('sourceFilter');
            filterSelect.innerHTML = '<option value="">all sources</option>' +
                sources.map(s => `<option value="${s}">${s}</option>`).join('');
        }
        
        function generateNewQuiz() {
            // Shuffle and pick 10 random questions
            const shuffled = [...allQuestions].sort(() => Math.random() - 0.5);
            currentQuiz = shuffled.slice(0, 10);
            currentQuizIndex = 0;
            answeredQuestions = {};
            displayQuestion();
        }
        
        function displayQuestion() {
            if (currentQuiz.length === 0) return;
            
            const q = currentQuiz[currentQuizIndex];
            
            // Scenario
            const scenarioContainer = document.getElementById('scenarioContainer');
            scenarioContainer.innerHTML = q.Scenario ? `<p>${q.Scenario}</p>` : '';
            
            // Question
            document.getElementById('questionContainer').innerHTML = q.Question;
            
            // Choices
            const choicesContainer = document.getElementById('choicesContainer');
            choicesContainer.innerHTML = `
                <div class="choice" onclick="selectChoice('A')"><span class="choice-letter">a.</span> ${q.Choice_A}</div>
                <div class="choice" onclick="selectChoice('B')"><span class="choice-letter">b.</span> ${q.Choice_B}</div>
                <div class="choice" onclick="selectChoice('C')"><span class="choice-letter">c.</span> ${q.Choice_C}</div>
                <div class="choice" onclick="selectChoice('D')"><span class="choice-letter">d.</span> ${q.Choice_D}</div>
            `;
            
            // Answer section
            const answerContainer = document.getElementById('answerContainer');
            answerContainer.innerHTML = `
                <div class="correct-answer">answer: <span style="color: #551a8b;">${q.Correct_Answer}</span></div>
                ${q.Explanation ? `<div class="explanation"><div class="explanation-title">explanation:</div>${q.Explanation}</div>` : ''}
            `;
            answerContainer.classList.remove('visible');
            
            // Reset show answer button
            const showAnswerBtn = document.getElementById('showAnswerBtn');
            showAnswerBtn.classList.remove('show-answer');
            showAnswerBtn.classList.add('hidden-answer');
            
            // Update counter and nav
            document.getElementById('currentQuestion').innerHTML = currentQuizIndex + 1;
            document.getElementById('totalQuestions').innerHTML = currentQuiz.length;
            
            // Update nav buttons
            document.getElementById('prevBtn').disabled = currentQuizIndex === 0;
            document.getElementById('nextBtn').disabled = currentQuizIndex === currentQuiz.length - 1;
            
            // Update info
            document.getElementById('navInfo').innerHTML = 
                currentQuizIndex === currentQuiz.length - 1 
                    ? '<em>last question</em>' 
                    : '';
            
            // Scroll to top
            document.querySelector('.quiz-container').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        function toggleAnswer() {
            const answerContainer = document.getElementById('answerContainer');
            const btn = document.getElementById('showAnswerBtn');
            answerContainer.classList.toggle('visible');
            btn.classList.toggle('hidden-answer');
            btn.classList.toggle('show-answer');
            answeredQuestions[currentQuizIndex] = true;
        }
        
        function selectChoice(choice) {
            // Optional: highlight selected choice
            console.log(`Selected: ${choice}`);
        }
        
        function nextQuestion() {
            if (currentQuizIndex < currentQuiz.length - 1) {
                currentQuizIndex++;
                displayQuestion();
            }
        }
        
        function previousQuestion() {
            if (currentQuizIndex > 0) {
                currentQuizIndex--;
                displayQuestion();
            }
        }
        
        // Library Mode
        function filterLibrary() {
            const search = document.getElementById('searchBox').value.toLowerCase();
            const sourceFilter = document.getElementById('sourceFilter').value;
            
            libraryFilteredQuestions = allQuestions.filter(q => {
                const matchesSearch = !search || 
                    (q.Question && q.Question.toLowerCase().includes(search)) ||
                    (q.Scenario && q.Scenario.toLowerCase().includes(search)) ||
                    (q.Source && q.Source.toLowerCase().includes(search));
                
                const matchesSource = !sourceFilter || q.Source === sourceFilter;
                
                return matchesSearch && matchesSource;
            });
            
            renderLibrary();
        }
        
        function renderLibrary() {
            const container = document.getElementById('libraryContainer');
            
            if (libraryFilteredQuestions.length === 0) {
                container.innerHTML = '<div class="empty-message">no questions match your search</div>';
                document.getElementById('libraryStats').innerHTML = 'No results';
                return;
            }
            
            const html = libraryFilteredQuestions.map((q, idx) => `
                <div class="question-card" onclick="toggleCardExpand(this)">
                    <div class="question-card-header">
                        <div>
                            <div class="question-card-title">${q.Question}</div>
                            <div class="question-card-meta">${q.Source || 'Unknown Source'}</div>
                        </div>
                        <div class="expand-icon">▼</div>
                    </div>
                    <div class="question-card-content">
                        ${q.Scenario ? `<div class="card-scenario">${q.Scenario}</div>` : ''}
                        <div class="card-choices">
                            <div class="card-choice"><strong>a.</strong> ${q.Choice_A}</div>
                            <div class="card-choice"><strong>b.</strong> ${q.Choice_B}</div>
                            <div class="card-choice"><strong>c.</strong> ${q.Choice_C}</div>
                            <div class="card-choice"><strong>d.</strong> ${q.Choice_D}</div>
                        </div>
                        <div class="card-answer">
                            <div class="card-answer-label">answer: ${q.Correct_Answer}</div>
                            ${q.Explanation ? `<div style="margin-top: 10px;">${q.Explanation}</div>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = html;
            document.getElementById('libraryStats').innerHTML = 
                `showing ${libraryFilteredQuestions.length} of ${allQuestions.length} questions`;
        }
        
        function toggleCardExpand(card) {
            // Close other cards
            document.querySelectorAll('.question-card').forEach(c => {
                if (c !== card) c.classList.remove('expanded');
            });
            // Toggle this card
            card.classList.toggle('expanded');
        }
        
        function switchMode(mode) {
            // Update buttons
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update views
            document.getElementById('quizMode').classList.add('hidden');
            document.getElementById('libraryMode').classList.add('hidden');
            
            if (mode === 'quiz') {
                document.getElementById('quizMode').classList.remove('hidden');
            } else {
                document.getElementById('libraryMode').classList.remove('hidden');
                filterLibrary();
            }
        }
        
        function updateFooter() {
            document.getElementById('totalQuestionsFooter').innerHTML = 
                `<strong>${allQuestions.length}</strong> total questions in bank`;
        }
    </script>
</body>
</html>
